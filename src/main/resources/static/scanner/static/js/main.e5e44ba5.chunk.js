(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{160:function(e,a,t){"use strict";t.r(a);t(76);var n=t(0),r=t.n(n),c=t(12),l=t.n(c),s=(t(81),t(82),t(16)),o=t(18),i=t(21),m=t.n(i),u=t(27),d=t(9),E=t(38),p=t.n(E),f=t(70),g=t.n(f),b=t(20),v=t(37),h=t.n(v),O=t(22),N=t.n(O);function y(e){return r.a.createElement(N.a,{show:e.show,onHide:e.onHide},r.a.createElement(N.a.Header,{closeButton:!0},r.a.createElement(N.a.Title,null,"Esc\xe1ner de partituras manuscritas")),r.a.createElement(N.a.Body,null,r.a.createElement("h5",null,"Informaci\xf3n del proyecto"),r.a.createElement("p",{className:"text-justify"},"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed consectetur quis leo eu cursus. Curabitur sit amet augue nec sapien posuere sodales. Aenean at egestas massa, sed hendrerit libero. Sed malesuada imperdiet purus, sed commodo leo fermentum at. Suspendisse vehicula rutrum dolor. Quisque posuere ipsum elit, et volutpat ligula volutpat posuere. Fusce pulvinar eros vel purus congue, non hendrerit arcu hendrerit. Vestibulum id vestibulum nulla. Proin quam orci, dictum eleifend nunc in, sodales maximus turpis. Nullam pretium sit amet tellus ac facilisis. Donec in felis ligula. Fusce vestibulum lorem vitae lectus pharetra interdum. Etiam sed pharetra quam."),r.a.createElement("h5",null,"Instrucciones de uso"),r.a.createElement("p",{className:"text-justify"},"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed consectetur quis leo eu cursus. Curabitur sit amet augue nec sapien posuere sodales. Aenean at egestas massa, sed hendrerit libero. Sed malesuada imperdiet purus, sed commodo leo fermentum at. Suspendisse vehicula rutrum dolor. Quisque posuere ipsum elit, et volutpat ligula volutpat posuere. Fusce pulvinar eros vel purus congue, non hendrerit arcu hendrerit. Vestibulum id vestibulum nulla. Proin quam orci, dictum eleifend nunc in, sodales maximus turpis. Nullam pretium sit amet tellus ac facilisis. Donec in felis ligula. Fusce vestibulum lorem vitae lectus pharetra interdum. Etiam sed pharetra quam.")))}function w(e){var a=Object(n.useState)(!1),t=Object(d.a)(a,2),c=t[0],l=t[1];return r.a.createElement("header",{className:"w-100 my-0"},r.a.createElement(y,{show:c,onHide:function(){return l(!1)}}),e.small?r.a.createElement(p.a,{variant:"light",bg:"white",className:"pt-1 pb-0 px-0"},r.a.createElement(u.LinkContainer,{to:"/"},r.a.createElement(p.a.Brand,null,r.a.createElement("img",{alt:"HISPAMUS",src:h.a,height:"25",className:"d-inline-block"}))),r.a.createElement(g.a,{className:"ml-auto"},r.a.createElement(m.a,{variant:"link",onClick:function(){return l(!0)}},r.a.createElement("i",{className:"fas fa-info-circle fa-2x"})))):r.a.createElement("div",{className:"row my-3"},r.a.createElement("div",{className:"col-9"},r.a.createElement(b.Link,{to:"/"},r.a.createElement("img",{className:"img-fluid",src:h.a,alt:"Logo"}))),r.a.createElement("div",{className:"col-3 d-flex justify-content-end align-items-center"},r.a.createElement(m.a,{variant:"link",onClick:function(){return l(!0)}},r.a.createElement("i",{className:"fas fa-info-circle fa-2x info-blink"})))))}function R(){return r.a.createElement("footer",{className:"w-100 mt-3 text-center border-top pt-3"},r.a.createElement("p",null,r.a.createElement("a",{href:"https://grfia.dlsi.ua.es",className:"text-dark"},"\xa9 GRFIA - Universidad de Alicante")))}function A(){return r.a.createElement("div",null,r.a.createElement(w,null),r.a.createElement("div",{className:"row px-3"},r.a.createElement("h4",null,"Esc\xe1ner de partituras manuscritas")),r.a.createElement("div",{className:"row mt-3"},r.a.createElement("div",{className:"col-12"},r.a.createElement(u.LinkContainer,{to:"/scan"},r.a.createElement(m.a,{variant:"primary",size:"lg",block:!0},r.a.createElement("i",{className:"fas fa-scroll"}),"\xa0Copiar una partitura")))),r.a.createElement(R,null))}var D=t(17);t(137);function x(){return r.a.createElement("div",{className:"w-100 mt-2"},r.a.createElement("div",{className:"d-flex flex-column flex-sm-row justify-content-sm-end"},r.a.createElement("div",{className:"d-inline-block mb-3 mx-sm-1 skeleton",style:{minWidth:"15ex"}},"\xa0"),r.a.createElement("div",{className:"d-inline-block mb-3 mx-sm-1 skeleton",style:{minWidth:"15ex"}},"\xa0")),r.a.createElement("div",{className:"d-block mr-3 skeleton",style:{width:"25ex"}},"\xa0"),r.a.createElement("div",{className:"d-block w-100 mt-4 skeleton",style:{height:"100px"}},"\xa0"))}function k(e){return r.a.createElement("div",{className:"w-100 my-3"},r.a.createElement("div",{className:"my-3"},"Ups! Algo ha ido mal"," ",r.a.createElement("span",{role:"img","aria-label":""},"\ud83e\udd37\ud83c\udffd\u200d\u2640\ufe0f")),r.a.createElement("button",{className:"btn btn-primary w-100",onClick:e.onReset},"Vuelve a intentarlo"))}function C(e){var a=Object(n.useState)(!1),t=Object(d.a)(a,2),c=t[0],l=t[1],s=r.a.createRef();function o(){l(!c)}return r.a.createElement("div",{className:"w-100 mt-2"},r.a.createElement("div",{className:"d-flex flex-column flex-sm-row justify-content-sm-end"},r.a.createElement("button",{className:"btn btn-danger mb-3 mx-1",onClick:e.onReset},r.a.createElement("i",{className:"fas fa-sync"})," Cargar otra"),r.a.createElement("label",{className:"btn btn-success mb-3 mx-1",htmlFor:"inputImage",title:"Escanear"},r.a.createElement("input",{type:"file",id:"inputImage",className:"sr-only",name:"file",accept:"image/*",ref:s,onChange:function(){s.current.files&&s.current.files.length>0&&e.onSelect(s.current.files[0])}}),r.a.createElement("i",{className:"fas fa-camera"})," Escanear versi\xf3n manuscrita")),r.a.createElement("h5",{className:"my-3"},e.score.title," (",e.score.author,")"),r.a.createElement("div",{className:"overflow-auto mt-3"},r.a.createElement("img",{className:c?"":"img-fluid",alt:"score",src:"data:image/png;base64,".concat(e.score.png),onClick:o})),r.a.createElement("div",{className:"w-100 mt-3 text-center"},r.a.createElement("button",{className:"btn btn-link text-dark text-decoration-none",onClick:o},r.a.createElement("i",{className:"fas fa-search-"+(c?"minus":"plus")})," ",r.a.createElement("small",null,"Click en la imagen para hacer zoom"))))}var I=t(71),j=t.n(I);t(138);function _(e){var a=Object(n.useState)(void 0),t=Object(d.a)(a,2),c=t[0],l=t[1],s=Object(n.useState)({x:10,y:10,width:100,height:100}),o=Object(d.a)(s,2),i=o[0],m=o[1];function u(a){var t=new FileReader;t.onloadend=function(){var a=t.result;e.onUpload(a)},t.readAsDataURL(a)}return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"w-100 mt-3"},r.a.createElement("button",{className:"btn btn-danger btn-block mb-3",onClick:e.onCancel},r.a.createElement("i",{className:"fas fa-times"})," Cancelar"),r.a.createElement("button",{className:"btn btn-success btn-block mb-3",onClick:function(){if(c){var e=document.createElement("canvas"),a=c.naturalWidth/c.width,t=c.naturalHeight/c.height,n=i.width*a,r=i.height*t;e.width=n,e.height=r,e.getContext("2d").drawImage(c,i.x*a,i.y*t,n,r,0,0,n,r),e.toBlob(u,"image/png")}}},r.a.createElement("i",{className:"fas fa-cloud-upload-alt"})," Enviar"),r.a.createElement(j.a,{src:e.image,crop:i,onImageLoaded:function(e,a){return l(e)},onChange:function(e){m(e)},alt:"imagen"})))}var L=t(73),S=t.n(L),U=t(72),P=t.n(U),G="/copymus/api/scanner/random/primus",F="/copymus/api/scanner/upload";function M(e){var a=Object(n.useState)(25),t=Object(d.a)(a,2),c=t[0],l=t[1],s=Object(n.useState)({image:e.image,score:e.score,onUpload:e.onUpload,onError:e.onError}),o=Object(d.a)(s,1)[0];return Object(n.useEffect)(function(){var e={png:o.image.replace("data:image/png;base64,",""),id:o.score.id,db:o.score.db};P.a.post(F,e,{headers:{"Content-Type":"application/json"},onUploadProgress:function(e){l(25+e.loaded/e.total*75)}}).then(function(e){o.onUpload()}).catch(function(e){o.onError()})},[o]),r.a.createElement(r.a.Fragment,null,r.a.createElement(S.a,{animated:!0,now:c,className:"my-3"}),r.a.createElement("img",{src:e.image,alt:"",className:"img-fluid d-block mx-auto"}))}var q={LOADING_SCORE:"loading_score",LOAD_ERROR:"load_error",LOADED_SCORE:"loaded_score",LOADED_IMAGE:"loaded_image",CROPPED_IMAGE:"cropped_image",UPLOAD_ERROR:"upload_error",UPLOADED_IMAGE:"uploaded_image",RESET:"reset"},B={reset:!0,loading:!1,error:!1,score:void 0,selectedImage:void 0,croppedImage:void 0};function H(e,a){switch(a.type){case q.LOADING_SCORE:return Object(D.a)({},e,{reset:!1,loading:!0});case q.LOAD_ERROR:return o.b.error("Error al cargar la partitura"),Object(D.a)({},e,{error:!0});case q.LOADED_SCORE:return Object(D.a)({},e,{loading:!1,score:a.payload,selectedImage:void 0});case q.LOADED_IMAGE:return Object(D.a)({},e,{error:!1,selectedImage:a.payload,croppedImage:void 0});case q.CROPPED_IMAGE:return Object(D.a)({},e,{error:!1,croppedImage:a.payload});case q.UPLOAD_ERROR:return o.b.error("Error al enviar la imagen"),Object(D.a)({},e,{error:!0});case q.UPLOADED_IMAGE:return o.b.success("\xa1Muchas gracias por colaborar!"),B;case q.RESET:return B;default:throw new Error}}function T(){var e=Object(n.useReducer)(H,B),a=Object(d.a)(e,2),t=a[0],c=a[1];return Object(n.useEffect)(function(){0},[t]),Object(n.useEffect)(function(){t.reset&&(c({type:q.LOADING_SCORE}),fetch(G).then(function(e){if(200===e.status)return e.json();throw new Error("No se puede contactar con el servidor")}).then(function(e){c({type:q.LOADED_SCORE,payload:e})}).catch(function(e){c({type:q.LOAD_ERROR}),console.error(e)}))},[t.reset]),r.a.createElement(r.a.Fragment,null,r.a.createElement(w,{small:!0}),t.loading&&!t.error&&r.a.createElement(x,null),t.loading&&t.error&&r.a.createElement(k,{onReset:function(){return c({type:q.RESET})}}),t.score&&!t.selectedImage&&r.a.createElement(C,{score:t.score,onSelect:function(e){var a=new FileReader;a.onload=function(){c({type:q.LOADED_IMAGE,payload:a.result})},a.readAsDataURL(e)},onReset:function(){return c({type:q.RESET})}}),t.selectedImage&&!t.croppedImage&&r.a.createElement(_,{image:t.selectedImage,onUpload:function(e){return c({type:q.CROPPED_IMAGE,payload:e})},onCancel:function(){return c({type:q.LOADED_SCORE,payload:t.score})}}),t.croppedImage&&!t.error&&r.a.createElement(M,{image:t.croppedImage,score:t.score,onUpload:function(){return c({type:q.UPLOADED_IMAGE})},onError:function(){return c({type:q.UPLOAD_ERROR})}}),t.croppedImage&&t.error&&r.a.createElement(k,{onReset:function(){return c({type:q.LOADED_IMAGE,payload:t.selectedImage})}}),r.a.createElement(R,null))}var W=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(s.a,null,r.a.createElement("div",{className:"container-fluid"},r.a.createElement(s.g,null,r.a.createElement(s.d,{exact:!0,path:"/",component:A}),r.a.createElement(s.d,{exact:!0,path:"/scan",component:T})))),r.a.createElement(o.a,{position:"bottom-center",bodyClassName:"text-center",autoClose:3e3,hideProgressBar:!0,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnVisibilityChange:!0,draggable:!1,pauseOnHover:!1}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(W,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},37:function(e,a,t){e.exports=t.p+"static/media/logo.cfbdceaa.png"},75:function(e,a,t){e.exports=t(160)},81:function(e,a,t){},82:function(e,a,t){}},[[75,1,2]]]);
//# sourceMappingURL=main.e5e44ba5.chunk.js.map